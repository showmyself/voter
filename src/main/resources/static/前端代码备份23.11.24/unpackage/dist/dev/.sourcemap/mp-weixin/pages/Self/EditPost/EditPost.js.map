{"version":3,"sources":["uni-app:///main.js",null,"webpack:///D:/Projects/UniappProjects/voter/pages/Self/EditPost/EditPost.vue?e19b","webpack:///D:/Projects/UniappProjects/voter/pages/Self/EditPost/EditPost.vue?fd59","webpack:///D:/Projects/UniappProjects/voter/pages/Self/EditPost/EditPost.vue?1860","uni-app:///pages/Self/EditPost/EditPost.vue","webpack:///D:/Projects/UniappProjects/voter/pages/Self/EditPost/EditPost.vue?c92d","webpack:///D:/Projects/UniappProjects/voter/pages/Self/EditPost/EditPost.vue?f2d1"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","prop","data","isAdd","post","id","title","content","picSrc","options","key","desc","link","endTime","maxVoteCount","category","number","commentAble","series","uploadUrl","showEndTime","timeParams","year","month","day","hour","minute","second","isSelectCategory","categoryList","isSelectSeries","seriesList","isAddOrEditOption","optionIndex","optionInput","refreshCallback","methods","openSelectCategory","label","value","confirmCategory","confirmEndTime","openSelectSeries","text","confirmSeries","toAddOption","toEditOption","removeOption","confirmAddOrEditOption","cancelAddOrEditOption","doAdd","doUpdate","beforeUploadPostPic","callback","onUploadPostPicSuccess","deleteLatestPostPic","beforeUploadOptionPic","onUploadOptionPicSuccess","deleteLatestOptionPic","deleteTargetPic","onLoad","onUnload"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,iBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqH;AACrH;AAC4D;AACL;AACc;;;AAGrE;AACuM;AACvM,gBAAgB,+MAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,mFAAM;AACR,EAAE,4FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,oMAEN;AACP,KAAK;AACL;AACA,aAAa,mQAEN;AACP,KAAK;AACL;AACA,aAAa,sNAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,aAAa,yQAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,aAAa,uPAEN;AACP,KAAK;AACL;AACA,aAAa,6MAEN;AACP,KAAK;AACL;AACA,aAAa,yNAEN;AACP,KAAK;AACL;AACA,aAAa,wLAEN;AACP,KAAK;AACL;AACA,aAAa,4NAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACnIA;AAAA;AAAA;AAAA;AAA4wB,CAAgB,4xBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eC4JhyB;EACAC;EACAC;IACA;MACAC;MAAA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC,UACA;UACAC;UAAA;UACAC;UACAH;UACAI;QACA,GACA;UAAA;UACAF;UACAC;UACAH;UACAI;QACA,EACA;QACAC;QACAC;QAEA;QACAC;QACAC;QACAN;QACAO;QACAC;MACA;MAEAC;MAEAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MAEAC;MACAC;MAEAC;MACAC;MAEA;MACAC;MACAC;MAAA;MACAC;QAAA;QACAxB;QAAA;QACAC;QACAH;QACAI;MACA;MAEAuB;IACA;EACA;;EACAC;IACAC;MACA;QAAAC;QAAAC;MAAA;MAAA,2CACA;QAAA;MAAA;QAAA;UAAA;UACA;YAAAD;YAAAC;UAAA;QACA;MAAA;QAAA;MAAA;QAAA;MAAA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MAAA;MACA;QACA;QACA;UACA;UACA;QACA;QAEA;UAAAC;QAAA;QAAA,4CACAZ;UAAA;QAAA;UAAA,uDACA;YAAA,IADAb;YACA;cAAAyB;YAAA;UAAA;QAAA;UAAA;QAAA;UAAA;QAAA;QACA;MACA;IACA;IACAC;MACA,gBACA,2BAEA;IACA;IACAC;MACA;QACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;QACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;QACA;QACA;MACA;MACA;QACA;QACA;MACA;;MAEA;MACA;MAEA,0BACA,iEAEA;MACA;IACA;IACAC;MACA;MACA;IACA;IAEAC;MAAA;MACA;QACA;QACA;MACA;MACA;QACA;QACA;MACA;MACA;QACA;QACA;MACA;MACA;QACA;QACA;MACA;MAEA;QACA;QACA;QACA;QACA;QACA;MACA;IACA;IACAC;MAAA;MACA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;IACA;IAEA;IACAC;MACAC;IACA;IACAC;MACA;MACA;IACA;IACAC;MAAA;MACA,4CACA;IACA;IACA;IACAC;MACAH;IACA;IACAI;MACA;MACA;IACA;IACAC;MACA,mDACA;IACA;IACAC;MACA;QACA;QACA;QACA;MACA;MACA;IACA;EACA;EACAC;IAAA;IACA;IAEA;MACA;QACA;QACA;MACA;IACA;MACA;IACA;EACA;EACAC;IACA;IACA;MACA;MACA;MACA;IACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;ACxYA;AAAA;AAAA;AAAA;AAA+7C,CAAgB,m5CAAG,EAAC,C;;;;;;;;;;;ACAn9C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/Self/EditPost/EditPost.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/Self/EditPost/EditPost.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./EditPost.vue?vue&type=template&id=6dbf5645&\"\nvar renderjs\nimport script from \"./EditPost.vue?vue&type=script&lang=js&\"\nexport * from \"./EditPost.vue?vue&type=script&lang=js&\"\nimport style0 from \"./EditPost.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/Self/EditPost/EditPost.vue\"\nexport default component.exports","export * from \"-!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./EditPost.vue?vue&type=template&id=6dbf5645&\"","var components\ntry {\n  components = {\n    myNavBar: function () {\n      return import(\n        /* webpackChunkName: \"components/my-nav-bar/my-nav-bar\" */ \"@/components/my-nav-bar/my-nav-bar.vue\"\n      )\n    },\n    uInput: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-input/u-input\" */ \"@/uview-ui/components/u-input/u-input.vue\"\n      )\n    },\n    myUploadImg: function () {\n      return import(\n        /* webpackChunkName: \"components/my-upload-img/my-upload-img\" */ \"@/components/my-upload-img/my-upload-img.vue\"\n      )\n    },\n    uSelect: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-select/u-select\" */ \"@/uview-ui/components/u-select/u-select.vue\"\n      )\n    },\n    uPicker: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-picker/u-picker\" */ \"@/uview-ui/components/u-picker/u-picker.vue\"\n      )\n    },\n    uSwitch: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-switch/u-switch\" */ \"@/uview-ui/components/u-switch/u-switch.vue\"\n      )\n    },\n    uActionSheet: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-action-sheet/u-action-sheet\" */ \"@/uview-ui/components/u-action-sheet/u-action-sheet.vue\"\n      )\n    },\n    uModal: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-modal/u-modal\" */ \"@/uview-ui/components/u-modal/u-modal.vue\"\n      )\n    },\n    uDivider: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-divider/u-divider\" */ \"@/uview-ui/components/u-divider/u-divider.vue\"\n      )\n    },\n    myEmpty: function () {\n      return import(\n        /* webpackChunkName: \"components/my-empty/my-empty\" */ \"@/components/my-empty/my-empty.vue\"\n      )\n    },\n    myOptionShow: function () {\n      return import(\n        /* webpackChunkName: \"components/my-option-show/my-option-show\" */ \"@/components/my-option-show/my-option-show.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.isAdd ? _vm.post.options.length : null\n  if (!_vm._isMounted) {\n    _vm.e0 = function () {\n      _vm.post.number = _vm.util.getRandomStr(8).toUpperCase()\n    }\n    _vm.e1 = function () {\n      _vm.post.key = _vm.util.getRandomStr(12)\n    }\n    _vm.e2 = function ($event) {\n      _vm.showEndTime = true\n    }\n    _vm.e3 = function ($event) {\n      _vm.post.endTime = null\n    }\n    _vm.e4 = function ($event) {\n      _vm.post.maxVoteCount = -1\n    }\n    _vm.e5 = function (index) {\n      var args = [],\n        len = arguments.length - 1\n      while (len-- > 0) args[len] = arguments[len + 1]\n\n      var _temp = args[args.length - 1].currentTarget.dataset,\n        _temp2 = _temp.eventParams || _temp[\"event-params\"],\n        index = _temp2.index\n      var _temp, _temp2\n      _vm.toEditOption(index)\n    }\n    _vm.e6 = function (index) {\n      var args = [],\n        len = arguments.length - 1\n      while (len-- > 0) args[len] = arguments[len + 1]\n\n      var _temp3 = args[args.length - 1].currentTarget.dataset,\n        _temp4 = _temp3.eventParams || _temp3[\"event-params\"],\n        index = _temp4.index\n      var _temp3, _temp4\n      _vm.removeOption(index)\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./EditPost.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./EditPost.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"my-page-root\">\r\n\t\t<my-nav-bar :title=\"isAdd?'新建':'更新'\"/>\r\n\t\t<view class=\"my-page-root-child form-page\">\r\n\r\n\t\t\t<view style=\"height: 20rpx;\"/>\r\n\t\t\t<text v-if=\"!isAdd\" style=\"color:orangered;font-size: 60%;margin-left: 40%;\">仅支持修改部分参数</text>\r\n\r\n\t\t\t<view class=\"form-area\">\r\n\r\n\t\t\t\t<view class=\"form-item\" v-if=\"isAdd\">\r\n\t\t\t\t\t<text class=\"lable\">名称</text>\r\n\t\t\t\t\t<input class=\"input\" v-model=\"post.title\" type=\"text\"/>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-item\" v-if=\"isAdd\">\r\n\t\t\t\t\t<text class=\"lable\">内容</text>\r\n\t\t\t\t\t<u-input v-model=\"post.content\" type=\"textarea\" border height=\"100\" :auto-height=\"true\"/>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-item\" v-if=\"isAdd\">\r\n\t\t\t\t\t<text class=\"lable\">参考图</text>\r\n\t\t\t\t\t<view>\r\n\t\t\t\t\t\t<my-upload-img\r\n\t\t\t\t\t\t:maxSize=\"2 * 1024 * 1024\"\r\n\t\t\t\t\t\t:url=\"uploadUrl\"\r\n\t\t\t\t\t\t@beforeUpload=\"beforeUploadPostPic\"\r\n\t\t\t\t\t\t@onUploadSuccess=\"onUploadPostPicSuccess\">\r\n\t\t\t\t\t\t</my-upload-img>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<input class=\"input\" type=\"text\" v-model=\"post.picSrc\"/>\r\n\t\t\t\t\t<image v-if=\"post.picSrc\" mode=\"aspectFit\" style=\"max-width: 100%\" :src=\"post.picSrc\"/>\r\n\t\t\t\t\t<button v-if=\"post.picSrc\" @click=\"deleteLatestPostPic\">清除</button>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<text class=\"lable\">类别</text>\r\n\t\t\t\t\t<button @click=\"openSelectCategory\">{{post.category?post.category:\"不指定\"}}</button>\r\n\t\t\t\t\t<u-select v-model=\"isSelectCategory\" :list=\"categoryList\" @confirm=\"confirmCategory\"></u-select>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<text class=\"lable\">编号</text>\r\n\t\t\t\t\t<input class=\"input\" v-model=\"post.number\" type=\"text\"/>\r\n\t\t\t\t\t<button @click=\"()=>{post.number=util.getRandomStr(8).toUpperCase()}\">随机生成</button>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<text class=\"lable\">秘钥</text>\r\n\t\t\t\t\t<input class=\"input\" v-model=\"post.key\" type=\"text\"/>\r\n\t\t\t\t\t<button @click=\"()=>{post.key=util.getRandomStr(12)}\">随机生成</button>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-item\" v-if=\"isAdd\">\r\n\t\t\t\t\t<text class=\"lable\">时限</text>\r\n\t\t\t\t\t<view style=\"color:royalblue\">\r\n\t\t\t\t\t\t{{post.endTime?post.endTime:\"不限时间\"}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"my-flex-usual\">\r\n\t\t\t\t\t\t<button @click=\"showEndTime = true\" style=\"width: 50%;\">选择</button>\r\n\t\t\t\t\t\t<button @click=\"post.endTime = null\" style=\"width: 50%;\">不限</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<!--u-picker与u-select类似，推荐使用后者，但对于时间和地区的选区，就直接用picker-->\r\n\t\t\t\t\t<u-picker v-model=\"showEndTime\" mode=\"time\" :params=\"timeParams\" @confirm=\"confirmEndTime\"></u-picker>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-item\" v-if=\"isAdd\">\r\n\t\t\t\t\t<text class=\"lable\">最大投票数</text>\r\n\t\t\t\t\t<input class=\"input\" style=\"color:royalblue\" v-model=\"post.maxVoteCount\" type=\"number\"/>\r\n\t\t\t\t\t<view v-if=\"isAdd\">\r\n\t\t\t\t\t\t<button @click=\"post.maxVoteCount = -1\">不限</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-item my-flex-usual\">\r\n\t\t\t\t\t<view class=\"lable\" width=\"20%\">允许评论</view>\r\n\t\t\t\t\t<view style=\"width: 20%;\" class=\"my-center-one\">\r\n\t\t\t\t\t\t<u-switch v-model=\"post.commentAble\" :size=\"35\"/>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<text class=\"lable\">系列</text>\r\n\t\t\t\t\t<input class=\"input\" v-model=\"post.series\" type=\"text\"/>\r\n\t\t\t\t\t<button @click=\"openSelectSeries\">选择</button>\r\n\t\t\t\t\t<u-action-sheet v-model=\"isSelectSeries\" :list=\"seriesList\" @click=\"confirmSeries\"/>\r\n\t\t\t\t\t<!-- <u-select v-model=\"isSelectSeries\" :list=\"seriesList\" @confirm=\"confirmSeries\"></u-select> -->\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-item\" v-if=\"isAdd\">\r\n\t\t\t\t\t<text class=\"lable\">选项：</text>\r\n\t\t\t\t\t<view>\r\n\t\t\t\t\t\t<button @click=\"toAddOption\">添加新选项</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view v-if=\"isAdd\">\r\n\t\t\t\t\t\t<u-modal v-model=\"isAddOrEditOption\"\r\n\t\t\t\t\t\t:title-style=\"{color: 'cornflowerblue'}\"\r\n\t\t\t\t\t\t@confirm=\"confirmAddOrEditOption\"\r\n\t\t\t\t\t\t@cancel=\"cancelAddOrEditOption\"\r\n\t\t\t\t\t\t:show-cancel-button=\"true\">\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<view class=\"slot-content\" style=\"width: 90%;margin: 0 auto;font-size: 80%;\">\r\n\t\t\t\t\t\t\t\t<text class=\"lable\">选项名：</text>\r\n\t\t\t\t\t\t\t\t<input class=\"input\" type=\"text\" v-model=\"optionInput.desc\"/>\r\n\t\t\t\t\t\t\t\t<view style=\"margin-top: 20rpx;\"></view>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<text class=\"lable\">参考链接：</text>\r\n\t\t\t\t\t\t\t\t<input class=\"input\" type=\"text\" v-model=\"optionInput.link\"/>\r\n\t\t\t\t\t\t\t\t<view style=\"margin-top: 20rpx;\"></view>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<text class=\"lable\">图片链接</text>\r\n\t\t\t\t\t\t\t\t\t<my-upload-img\r\n\t\t\t\t\t\t\t\t\t:maxSize=\"1 * 1024 * 1024\"\r\n\t\t\t\t\t\t\t\t\t:url=\"uploadUrl\"\r\n\t\t\t\t\t\t\t\t\t@beforeUpload=\"beforeUploadOptionPic\"\r\n\t\t\t\t\t\t\t\t\t@onUploadSuccess=\"onUploadOptionPicSuccess\">\r\n\t\t\t\t\t\t\t\t\t</my-upload-img>\r\n\t\t\t\t\t\t\t\t<input class=\"input\" type=\"text\" v-model=\"optionInput.picSrc\"/>\r\n\t\t\t\t\t\t\t\t<image v-if=\"optionInput.picSrc\" mode=\"aspectFit\" style=\"max-width: 80%\" :src=\"optionInput.picSrc\"/>\r\n\t\t\t\t\t\t\t\t<button v-if=\"optionInput.picSrc\" @click=\"deleteLatestOptionPic\" style=\"color:red\">清除</button>\r\n\t\t\t\t\t\t\t\t<view style=\"margin-top: 20rpx;\"></view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</u-modal>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<u-divider color=\"#fa3534\"></u-divider>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<my-empty v-if=\"post.options.length==0\" type=\"post\" text=\"没有选项\"/>\r\n\t\t\t\t\t<view v-for=\"(option,index) in post.options\" :key=\"option.key\">\r\n\t\t\t\t\t\t<view style=\"margin-top: 10rpx;font-size: 60%;\">选项{{index}}：</view>\r\n\t\t\t\t\t\t<my-option-show :option=\"option\"/>\r\n\t\t\t\t\t\t<view v-if=\"isAdd\">\r\n\t\t\t\t\t\t\t<button style=\"display: inline-block;width: 50%;\" @click=\"()=>{toEditOption(index)}\">编辑</button>\r\n\t\t\t\t\t\t\t<button style=\"display: inline-block;width: 50%;color:#f99\" @click=\"()=>{removeOption(index)}\">删除</button>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view style=\"height: 60rpx;\"/>\r\n\t\t\t\t<view style=\"float:right\">\r\n\t\t\t\t\t<button v-if=\"isAdd\" class=\"confirm-button\" @click=\"doAdd\">\r\n\t\t\t\t\t\t确认发布\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button v-if=\"!isAdd\" class=\"confirm-button\" @click=\"doUpdate\">\r\n\t\t\t\t\t\t确认修改\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\n</template>\n\n<script>\n\texport default {\r\n\t\tprop:[\"editId\"],\n\t\tdata() {\n\t\t\treturn {\r\n\t\t\t\tisAdd:true,//本组件负责帖子的修改或新建，如果是修改，某些项无法修改\n\t\t\t\tpost:{\r\n\t\t\t\t\tid:\"\",\r\n\t\t\t\t\ttitle:\"\",\r\n\t\t\t\t\tcontent:\"\",\r\n\t\t\t\t\tpicSrc:\"\",\r\n\t\t\t\t\toptions:[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tkey:this.util.getTmpKey(),//此为仅前端使用的临时id，与后端设置的id无关\r\n\t\t\t\t\t\t\tdesc:\"A.\",\r\n\t\t\t\t\t\t\tpicSrc:\"\",\r\n\t\t\t\t\t\t\tlink:\"\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{//仅测试：\r\n\t\t\t\t\t\t\tkey:this.util.getTmpKey(),\r\n\t\t\t\t\t\t\tdesc:\"B.\",\r\n\t\t\t\t\t\t\tpicSrc:\"\",\r\n\t\t\t\t\t\t\tlink:\"\",\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tendTime:\"\",\r\n\t\t\t\t\tmaxVoteCount:0,\r\n\t\t\t\t\t\r\n\t\t\t\t\t//编辑情况下无法改动上述这些，但下面这些是可以改的\r\n\t\t\t\t\tcategory:\"\",\r\n\t\t\t\t\tnumber:\"\",\r\n\t\t\t\t\tkey:\"\",\r\n\t\t\t\t\tcommentAble:true,\r\n\t\t\t\t\tseries:\"\",\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\tuploadUrl:\"\",\r\n\t\t\t\t\r\n\t\t\t\tshowEndTime:false,\r\n\t\t\t\ttimeParams:{\n\t\t\t\t\tyear: true,\n\t\t\t\t\tmonth: true,\n\t\t\t\t\tday: true,\n\t\t\t\t\thour: true,\n\t\t\t\t\tminute: true,\n\t\t\t\t\tsecond: false\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\tisSelectCategory:false,\r\n\t\t\t\tcategoryList:[],\r\n\t\t\t\t\r\n\t\t\t\tisSelectSeries:false,\r\n\t\t\t\tseriesList:[],\r\n\r\n\t\t\t\t//对选项的新增或编辑 都是在新增帖子时才有的\r\n\t\t\t\tisAddOrEditOption:false,\r\n\t\t\t\toptionIndex:-1,//为-1表示当前正在新增选项，否则为更新\r\n\t\t\t\toptionInput:{//当前正新增或编辑的选项\r\n\t\t\t\t\tkey:\"-1\",//仅前端使用的临时id，与后端设置的id无关\r\n\t\t\t\t\tdesc:\"1\",\r\n\t\t\t\t\tpicSrc:\"\",\r\n\t\t\t\t\tlink:\"1\",\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\trefreshCallback:null,//添加完成后的回调\n\t\t\t}\n\t\t},\r\n\t\tmethods:{\r\n\t\t\topenSelectCategory(){\r\n\t\t\t\tthis.categoryList = [{label:\"不指定\",value:\"\"}]\r\n\t\t\t\tfor(const cate of this.constant.categories){\r\n\t\t\t\t\tthis.categoryList.push({label:cate,value:cate})\r\n\t\t\t\t}\r\n\t\t\t\tthis.isSelectCategory=true\r\n\t\t\t},\r\n\t\t\tconfirmCategory(option){\r\n\t\t\t\tthis.post.category = option[0].value\r\n\t\t\t},\r\n\t\t\tconfirmEndTime(time){\r\n\t\t\t\tthis.post.endTime = time.year+\"-\"+time.month+\"-\"+time.day+\" \"+time.hour+\":\"+time.minute\r\n\t\t\t},\r\n\t\t\topenSelectSeries(){\r\n\t\t\t\tthis.api.post.getAllSelfSeries((data)=>{\r\n\t\t\t\t\tconst seriesList = data.seriesList\r\n\t\t\t\t\tif(seriesList.length==0){\r\n\t\t\t\t\t\tthis.util.toast(\"当前还没有定义系列名\")\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.seriesList = [{text:\"不设置\"}]\r\n\t\t\t\t\tfor(const series of seriesList)\r\n\t\t\t\t\t\tthis.seriesList.push({text:series})\r\n\t\t\t\t\tthis.isSelectSeries=true\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tconfirmSeries(index){\r\n\t\t\t\tif(index==0)\r\n\t\t\t\t\tthis.post.series = \"\"\r\n\t\t\t\telse\r\n\t\t\t\t\tthis.post.series = this.seriesList[index].text;\r\n\t\t\t},\r\n\t\t\ttoAddOption(){\r\n\t\t\t\tfor(const key in this.optionInput){\r\n\t\t\t\t\tthis.optionInput[key]=\"\"\r\n\t\t\t\t}\r\n\t\t\t\tthis.optionIndex=-1\r\n\t\t\t\tthis.isAddOrEditOption=true\r\n\t\t\t},\r\n\t\t\ttoEditOption(index){\r\n\t\t\t\tconst targetOption = this.post.options[index]\r\n\t\t\t\tfor(const key in targetOption){\r\n\t\t\t\t\tthis.optionInput[key]=targetOption[key]\r\n\t\t\t\t}\r\n\t\t\t\tthis.optionIndex=index\r\n\t\t\t\tthis.isAddOrEditOption=true\r\n\t\t\t},\r\n\t\t\tremoveOption(index){\r\n\t\t\t\tthis.deleteTargetPic(this.post.options[index].picSrc)\r\n\t\t\t\tthis.post.options.splice(index,1)\r\n\t\t\t},\r\n\t\t\tconfirmAddOrEditOption(){\r\n\t\t\t\tthis.isAddOrEditOption=true\r\n\t\t\t\tif(!this.optionInput.desc){\r\n\t\t\t\t\tthis.util.toast(\"选项描述不能为空\")\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif(this.optionInput.desc.length>36){\r\n\t\t\t\t\tthis.util.toast(\"选项描述过长\")\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//新增的话就给一个新key，否则保持原来的key\r\n\t\t\t\tthis.optionInput.key = this.optionIndex<0?this.util.getTmpKey():this.optionInput.key\r\n\t\t\t\t\t\r\n\t\t\t\tif(this.optionIndex<0)\r\n\t\t\t\t\tthis.post.options.push({...this.optionInput})\r\n\t\t\t\telse\r\n\t\t\t\t\tthis.post.options.splice(this.optionIndex,1,{...this.optionInput})\r\n\t\t\t\tthis.isAddOrEditOption=false\r\n\t\t\t},\r\n\t\t\tcancelAddOrEditOption(){\r\n\t\t\t\tthis.deleteLatestOptionPic()\r\n\t\t\t\tthis.isAddOrEditOption=false\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tdoAdd(){\r\n\t\t\t\tif(!this.post.title){\r\n\t\t\t\t\tthis.util.toast(\"标题不能为空\")\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif(!this.post.number){\r\n\t\t\t\t\tthis.util.toast(\"编号不能为空\")\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif(this.post.options.length<=1){\r\n\t\t\t\t\tthis.util.toast(\"选项数至少为2\")\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif(this.post.options.length>16){\r\n\t\t\t\t\tthis.util.toast(\"选项数最多16\")\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.api.post.add(this.post,(data)=>{\r\n\t\t\t\t\t//此处置为空避免触发冗余回收机制\r\n\t\t\t\t\tthis.post.picSrc=null\r\n\t\t\t\t\tthis.optionInput.picSrc=null\r\n\t\t\t\t\tthis.util.routeBack()\r\n\t\t\t\t\tthis.util.toast(\"添加成功\")\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tdoUpdate(){\r\n\t\t\t\tif(!this.post.number){\r\n\t\t\t\t\tthis.util.toast(\"编号不能为空\")\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.api.post.update(this.post,(data)=>{\r\n\t\t\t\t\tthis.util.routeBack()\r\n\t\t\t\t\tthis.util.toast(\"修改成功\")\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t//关于上传相关细节，参考SelfDetails.vue\r\n\t\t\tbeforeUploadPostPic(data,callback){\r\n\t\t\t\tcallback(true)\r\n\t\t\t},\r\n\t\t\tonUploadPostPicSuccess(resultData){\r\n\t\t\t\tthis.deleteLatestPostPic()\r\n\t\t\t\tthis.post.picSrc = resultData.url\r\n\t\t\t},\r\n\t\t\tdeleteLatestPostPic(){//清理的原因是避免冗余\r\n\t\t\t\tif(this.deleteTargetPic(this.post.picSrc))\r\n\t\t\t\t\tthis.post.picSrc=null\r\n\t\t\t},\r\n\t\t\t//-----上面是针对Post的图，下面是针对每个Option的图\r\n\t\t\tbeforeUploadOptionPic(data,callback){\r\n\t\t\t\tcallback(true)\r\n\t\t\t},\r\n\t\t\tonUploadOptionPicSuccess(resultData){\r\n\t\t\t\tthis.deleteLatestOptionPic()\r\n\t\t\t\tthis.optionInput.picSrc = resultData.url\r\n\t\t\t},\r\n\t\t\tdeleteLatestOptionPic(){\r\n\t\t\t\tif(this.deleteTargetPic(this.optionInput.picSrc))\r\n\t\t\t\t\tthis.optionInput.picSrc=null\r\n\t\t\t},\r\n\t\t\tdeleteTargetPic(picSrc){\r\n\t\t\t\tif(picSrc){\r\n\t\t\t\t\tconst names = picSrc.split('/')\r\n\t\t\t\t\tthis.api.post.deletePicture(names[names.length-1])\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t},\r\n\t\t},\r\n\t\tonLoad(routeParamObj){\r\n\t\t\tthis.uploadUrl = this.api.post.getUploadPictureUrl()\r\n\t\t\t\r\n\t\t\tif(routeParamObj&&routeParamObj.editId){\r\n\t\t\t\tthis.api.post.getById(routeParamObj.editId,routeParamObj.editKey,(data)=>{\r\n\t\t\t\t\tthis.post=data\r\n\t\t\t\t\tthis.isAdd=false\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n\t\t\t\tthis.post.number=this.util.getRandomStr(8).toUpperCase()\r\n\t\t\t}\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\t//路由返回会导致页面的卸载\r\n\t\t\tif(this.isAdd){\r\n\t\t\t\t//如果是添加成功后的返回，记得先赋值连接为null，避免此处误删\r\n\t\t\t\tthis.deleteLatestPostPic()\r\n\t\t\t\tthis.deleteLatestOptionPic()\r\n\t\t\t}\r\n\t\t\t//编辑帖子的情况下，无法改动pic，所以无需删除\r\n\t\t},\n\t}\n</script>\n\n<style lang=\"scss\">\n\r\n@import \"@/common/my-class.scss\";\r\n@import \"@/pages/Self/_common.scss\";\r\n\n</style>\n","import mod from \"-!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./EditPost.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\Softwares\\\\HBuilderX.full.3.3.11\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./EditPost.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1694785026436\n      var cssReload = require(\"E:/Softwares/HBuilderX.full.3.3.11/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}