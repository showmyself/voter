<view class="my-page-root"><my-nav-bar vue-id="4a2bf361-1" title="{{isAdd?'新建':'更新'}}" bind:__l="__l"></my-nav-bar><view class="my-page-root-child form-page"><view style="height:20rpx;"></view><block wx:if="{{!isAdd}}"><text style="color:orangered;font-size:60%;margin-left:40%;">仅支持修改部分参数</text></block><view class="form-area"><block wx:if="{{isAdd}}"><view class="form-item"><text class="lable">名称</text><input class="input" type="text" data-event-opts="{{[['input',[['__set_model',['$0','title','$event',[]],['post']]]]]}}" value="{{post.title}}" bindinput="__e"/></view></block><block wx:if="{{isAdd}}"><view class="form-item"><text class="lable">内容</text><u-input bind:input="__e" vue-id="4a2bf361-2" type="textarea" border="{{true}}" height="100" auto-height="{{true}}" value="{{post.content}}" data-event-opts="{{[['^input',[['__set_model',['$0','content','$event',[]],['post']]]]]}}" bind:__l="__l"></u-input></view></block><block wx:if="{{isAdd}}"><view class="form-item"><text class="lable">参考图</text><view><my-upload-img vue-id="4a2bf361-3" maxSize="{{2*1024*1024}}" url="{{uploadUrl}}" data-event-opts="{{[['^beforeUpload',[['beforeUploadPostPic']]],['^onUploadSuccess',[['onUploadPostPicSuccess']]]]}}" bind:beforeUpload="__e" bind:onUploadSuccess="__e" bind:__l="__l"></my-upload-img></view><input class="input" type="text" data-event-opts="{{[['input',[['__set_model',['$0','picSrc','$event',[]],['post']]]]]}}" value="{{post.picSrc}}" bindinput="__e"/><block wx:if="{{post.picSrc}}"><image style="max-width:100%;" mode="aspectFit" src="{{post.picSrc}}"></image></block><block wx:if="{{post.picSrc}}"><button data-event-opts="{{[['tap',[['deleteLatestPostPic',['$event']]]]]}}" bindtap="__e">清除</button></block></view></block><view class="form-item"><text class="lable">类别</text><button data-event-opts="{{[['tap',[['openSelectCategory',['$event']]]]]}}" bindtap="__e">{{post.category?post.category:"不指定"}}</button><u-select vue-id="4a2bf361-4" list="{{categoryList}}" value="{{isSelectCategory}}" data-event-opts="{{[['^confirm',[['confirmCategory']]],['^input',[['__set_model',['','isSelectCategory','$event',[]]]]]]}}" bind:confirm="__e" bind:input="__e" bind:__l="__l"></u-select></view><view class="form-item"><text class="lable">编号</text><input class="input" type="text" data-event-opts="{{[['input',[['__set_model',['$0','number','$event',[]],['post']]]]]}}" value="{{post.number}}" bindinput="__e"/><button data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" bindtap="__e">随机生成</button></view><view class="form-item"><text class="lable">秘钥</text><input class="input" type="text" data-event-opts="{{[['input',[['__set_model',['$0','key','$event',[]],['post']]]]]}}" value="{{post.key}}" bindinput="__e"/><button data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" bindtap="__e">随机生成</button></view><block wx:if="{{isAdd}}"><view class="form-item"><text class="lable">时限</text><view style="color:royalblue;">{{''+(post.endTime?post.endTime:"不限时间")+''}}</view><view class="my-flex-usual"><button data-event-opts="{{[['tap',[['e2',['$event']]]]]}}" style="width:50%;" bindtap="__e">选择</button><button data-event-opts="{{[['tap',[['e3',['$event']]]]]}}" style="width:50%;" bindtap="__e">不限</button></view><u-picker vue-id="4a2bf361-5" mode="time" params="{{timeParams}}" value="{{showEndTime}}" data-event-opts="{{[['^confirm',[['confirmEndTime']]],['^input',[['__set_model',['','showEndTime','$event',[]]]]]]}}" bind:confirm="__e" bind:input="__e" bind:__l="__l"></u-picker></view></block><block wx:if="{{isAdd}}"><view class="form-item"><text class="lable">最大投票数</text><input class="input" style="color:royalblue;" type="number" data-event-opts="{{[['input',[['__set_model',['$0','maxVoteCount','$event',[]],['post']]]]]}}" value="{{post.maxVoteCount}}" bindinput="__e"/><block wx:if="{{isAdd}}"><view><button data-event-opts="{{[['tap',[['e4',['$event']]]]]}}" bindtap="__e">不限</button></view></block></view></block><view class="form-item my-flex-usual"><view class="lable" width="20%">允许评论</view><view class="my-center-one" style="width:20%;"><u-switch bind:input="__e" vue-id="4a2bf361-6" size="{{35}}" value="{{post.commentAble}}" data-event-opts="{{[['^input',[['__set_model',['$0','commentAble','$event',[]],['post']]]]]}}" bind:__l="__l"></u-switch></view></view><view class="form-item"><text class="lable">系列</text><input class="input" type="text" data-event-opts="{{[['input',[['__set_model',['$0','series','$event',[]],['post']]]]]}}" value="{{post.series}}" bindinput="__e"/><button data-event-opts="{{[['tap',[['openSelectSeries',['$event']]]]]}}" bindtap="__e">选择</button><u-action-sheet vue-id="4a2bf361-7" list="{{seriesList}}" value="{{isSelectSeries}}" data-event-opts="{{[['^click',[['confirmSeries']]],['^input',[['__set_model',['','isSelectSeries','$event',[]]]]]]}}" bind:click="__e" bind:input="__e" bind:__l="__l"></u-action-sheet></view><block wx:if="{{isAdd}}"><view class="form-item"><text class="lable">选项：</text><view><button data-event-opts="{{[['tap',[['toAddOption',['$event']]]]]}}" bindtap="__e">添加新选项</button></view><block wx:if="{{isAdd}}"><view><u-modal vue-id="4a2bf361-8" title-style="{{({color:'cornflowerblue'})}}" show-cancel-button="{{true}}" value="{{isAddOrEditOption}}" data-event-opts="{{[['^confirm',[['confirmAddOrEditOption']]],['^cancel',[['cancelAddOrEditOption']]],['^input',[['__set_model',['','isAddOrEditOption','$event',[]]]]]]}}" bind:confirm="__e" bind:cancel="__e" bind:input="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="slot-content" style="width:90%;margin:0 auto;font-size:80%;"><text class="lable">选项名：</text><input class="input" type="text" data-event-opts="{{[['input',[['__set_model',['$0','desc','$event',[]],['optionInput']]]]]}}" value="{{optionInput.desc}}" bindinput="__e"/><view style="margin-top:20rpx;"></view><text class="lable">参考链接：</text><input class="input" type="text" data-event-opts="{{[['input',[['__set_model',['$0','link','$event',[]],['optionInput']]]]]}}" value="{{optionInput.link}}" bindinput="__e"/><view style="margin-top:20rpx;"></view><text class="lable">图片链接</text><my-upload-img vue-id="{{('4a2bf361-9')+','+('4a2bf361-8')}}" maxSize="{{1*1024*1024}}" url="{{uploadUrl}}" data-event-opts="{{[['^beforeUpload',[['beforeUploadOptionPic']]],['^onUploadSuccess',[['onUploadOptionPicSuccess']]]]}}" bind:beforeUpload="__e" bind:onUploadSuccess="__e" bind:__l="__l"></my-upload-img><input class="input" type="text" data-event-opts="{{[['input',[['__set_model',['$0','picSrc','$event',[]],['optionInput']]]]]}}" value="{{optionInput.picSrc}}" bindinput="__e"/><block wx:if="{{optionInput.picSrc}}"><image style="max-width:80%;" mode="aspectFit" src="{{optionInput.picSrc}}"></image></block><block wx:if="{{optionInput.picSrc}}"><button data-event-opts="{{[['tap',[['deleteLatestOptionPic',['$event']]]]]}}" style="color:red;" bindtap="__e">清除</button></block><view style="margin-top:20rpx;"></view></view></u-modal></view></block><u-divider vue-id="4a2bf361-10" color="#fa3534" bind:__l="__l"></u-divider><block wx:if="{{$root.g0==0}}"><my-empty vue-id="4a2bf361-11" type="post" text="没有选项" bind:__l="__l"></my-empty></block><block wx:for="{{post.options}}" wx:for-item="option" wx:for-index="index" wx:key="key"><view><view style="margin-top:10rpx;font-size:60%;">{{"选项"+index+"："}}</view><my-option-show vue-id="{{'4a2bf361-12-'+index}}" option="{{option}}" bind:__l="__l"></my-option-show><block wx:if="{{isAdd}}"><view><button data-event-opts="{{[['tap',[['e5',['$event']]]]]}}" data-event-params="{{({index})}}" style="display:inline-block;width:50%;" bindtap="__e">编辑</button><button data-event-opts="{{[['tap',[['e6',['$event']]]]]}}" data-event-params="{{({index})}}" style="display:inline-block;width:50%;color:#f99;" bindtap="__e">删除</button></view></block></view></block></view></block><view style="height:60rpx;"></view><view style="float:right;"><block wx:if="{{isAdd}}"><button data-event-opts="{{[['tap',[['doAdd',['$event']]]]]}}" class="confirm-button" bindtap="__e">确认发布</button></block><block wx:if="{{!isAdd}}"><button data-event-opts="{{[['tap',[['doUpdate',['$event']]]]]}}" class="confirm-button" bindtap="__e">确认修改</button></block></view></view></view></view>